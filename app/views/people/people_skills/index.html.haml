%turbo-frame#people-skill-form.d-flex.gap-3.col-12
  = render('people/scroll_to_menu', items: Category.all_parents.pluck(:title), translate: false) do
    = link_to image_tag("pencil-square.svg")+ t("helpers.submit.edit", model: Skill.model_name.plural.capitalize()),
    people_skills_edit_person_path(@person)
    = link_to image_tag("plus-lg.svg") + t("helpers.submit.add", model: Skill), new_person_people_skill_path(@person), 
    data: { turbo_frame: "remote_modal"}
  %div.w-100{data: { "scroll-target": "parent"}}
    %p.d-flex.align-items-center.profile-header
      Skills
      ="(#{@person.people_skills.count})"
    %div.ms-3
      = form_with(url: person_people_skills_path(@person), method: :get, data: {controller: "filter", turbo_frame: "people-skills"}) do |f|
        %span.btn-group
          - rating = request.query_parameters[:rating]
          = f.radio_button :rating, 1, class: "btn-check", checked: rating == "1",
            onClick: "this.form.requestSubmit()", data: {action: "change->filter#submit"}
          = f.label :rating, t("people-skills.filter.all"), value: 1, class: "btn btn-outline-primary"

          = f.radio_button :rating, 0, class: "btn-check", checked: rating == "0",
            onClick: "this.form.requestSubmit()", data: {action: "change->filter#submit"}
          = f.label :rating, t("people-skills.filter.rated"), value: 0, class: "btn btn-outline-primary"

          = f.radio_button :rating, -1, class: "btn-check", checked: rating == "-1",
            onClick: "this.form.requestSubmit()", data: {action: "change->filter#submit"}
          = f.label :rating, t("people-skills.filter.unrated"), value: -1, class: "btn btn-outline-primary"
      = turbo_frame_tag 'people-skills' do
        - Category.all_parents.each do |category|
          %div.profile-header.mw-100.border-bottom.mt-4{id: category.title.parameterize, "data-scroll-target": "scrollItem"}
            = category.title
          - ([category] + category.children.to_a).each do |category_child|
            %div.white-header.mw-100.border-bottom.text-gray
              - @people_skills_of_category = people_skills_of_category(category_child)
              =category_child.title + " (#{@people_skills_of_category.count})"
              - @people_skills_of_category.each do |person_skill|
                %div.mw-100.border-bottom.text-black.ps-5.border
                  %div.d-flex.flex-row.align-items-center.mt-3.mb-3
                    = render("people_skills/person_skill", {person_skill: person_skill})